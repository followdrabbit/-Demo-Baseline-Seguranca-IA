
Controles enriquecidos

### **Crie um Endpoint de Interface VPC para Amazon EC2**
   - **Controle ID:** ec2_endpoint_control_001
   - **Racional:** Utilizar endpoints de interface VPC para acessar o EC2 reduz a exposição da rede ao eliminar a necessidade de tráfego de dados passar pela Internet pública.
   - **Riscos Mitigados:** Mitiga o risco de exposição de dados e acesso não autorizado, pois o tráfego entre a VPC e o EC2 ocorre totalmente dentro da rede da AWS.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço VPC.
     2. No painel de navegação, clique em 'Endpoints'.
     3. Verifique a lista de endpoints para encontrar um endpoint do tipo Interface associado ao serviço 'com.amazonaws.region.ec2'.
     4. Confirme que o endpoint está associado às sub-redes corretas e que as políticas de endpoint permitem o tráfego apropriado para e do EC2.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço VPC.
     2. No painel de navegação, clique em 'Endpoints' e depois em 'Create Endpoint'.
     3. Selecione 'Interface' como o tipo de endpoint e escolha o serviço 'com.amazonaws.region.ec2' para o qual você deseja criar o endpoint.
     4. Escolha a VPC e as sub-redes onde o endpoint deve ser criado. Configure as configurações de segurança, como grupos de segurança que permitem tráfego necessário.
     5. Revise as configurações e clique em 'Create Endpoint'.
   - **Referências:**
     - [Documentação oficial da AWS sobre endpoints de interface VPC](https://docs.aws.amazon.com/vpc/latest/userguide/vpce-interface.html)

### **Aplique uma Política de Endpoint Personalizada para Restringir a Criação e o Lançamento de Volumes e Instâncias Não Criptografadas**
   - **Controle ID:** ec2_endpoint_control_002
   - **Racional:** Aplicar políticas de endpoint personalizadas para restringir a criação de volumes e instâncias não criptografadas aumenta a segurança dos dados, garantindo que todas as novas instâncias e volumes estejam criptografados por padrão.
   - **Riscos Mitigados:** Mitiga o risco de exposição de dados sensíveis e não autorizados, fortalecendo a postura de segurança da infraestrutura de nuvem.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço VPC.
     2. No painel de navegação, clique em 'Endpoints'.
     3. Selecione o endpoint relevante e visualize a política de endpoint em vigor.
     4. Verifique se a política inclui regras que proíbam a criação de volumes e instâncias EC2 não criptografadas.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço VPC.
     2. No painel de navegação, clique em 'Endpoints' e depois selecione o endpoint que você deseja configurar.
     3. Clique em 'Modificar política' para editar a política de endpoint existente.
     4. Insira uma política que especifique a restrição de criar e lançar volumes e instâncias EC2 não criptografadas, como mostrado no exemplo abaixo:
        ```json
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Deny",
              "Action": [
                "ec2:RunInstances",
                "ec2:CreateVolume"
              ],
              "Resource": "*",
              "Condition": {
                "Bool": {"ec2:Encrypted": "false"}
              }
            }
          ]
        }
        ```
     5. Salve e aplique a política.
   - **Referências:**
     - [Documentação oficial da AWS sobre criação de políticas de endpoint](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints-access.html#vpc-endpoints-policies)
	 
### **Implemente Federação de Identidade com um Provedor de Identidade e Papéis IAM para Gerenciar o Acesso**
   - **Controle ID:** ec2_endpoint_control_003
   - **Racional:** A implementação da federação de identidade com um provedor de identidade externo permite a gestão centralizada de credenciais e políticas de acesso, reduzindo o risco de acesso não autorizado e facilitando o cumprimento de políticas de segurança corporativas.
   - **Riscos Mitigados:** Mitiga o risco de comprometimento de credenciais estáticas e facilita a conformidade e auditoria ao centralizar o gerenciamento de acessos.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço IAM (Identity and Access Management).
     2. No painel de navegação, clique em 'Identity Providers' e verifique se existe um provedor de identidade configurado.
     3. Clique em 'Roles' e revise as políticas associadas aos papéis que são utilizados para federação para garantir que estão corretamente configuradas para limitar acessos baseados em afirmações do provedor de identidade.
     4. Verifique se há registros de auditoria (como CloudTrail) para garantir que o acesso via federação está sendo usado adequadamente.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço IAM.
     2. No painel de navegação, clique em 'Identity Providers' e depois em 'Add Provider'.
     3. Escolha o tipo de provedor (como SAML), forneça os detalhes necessários (como metadados do provedor SAML) e crie o provedor de identidade.
     4. Crie papéis IAM que serão assumidos por usuários autenticados via federação:
        - Clique em 'Create role', selecione 'SAML 2.0 federation', e vincule o provedor de identidade que você criou.
        - Defina as políticas que controlam o que os usuários federados podem fazer quando assumirem o papel.
     5. Configure o provedor de identidade para enviar as afirmações corretas que correspondam às políticas dos papéis IAM.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia para configuração de provedores de identidade no IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers.html)

### **Aplique Regras de Grupo de Segurança o Menos Permissivas Possível**
   - **Controle ID:** ec2_endpoint_control_004
   - **Racional:** Aplicar regras de grupo de segurança menos permissivas é fundamental para minimizar a superfície de ataque, limitando o acesso apenas aos recursos que estritamente precisam de comunicação entre si.
   - **Riscos Mitigados:** Mitiga o risco de acessos indevidos e potenciais ataques internos e externos, assegurando que apenas tráfegos necessários sejam permitidos.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. No painel de navegação, clique em 'Security Groups'.
     3. Selecione cada grupo de segurança listado e revise as regras de entrada e saída.
     4. Verifique se as regras aplicadas são as mínimas necessárias para o funcionamento da aplicação ou serviço, focando em restrições como IPs específicos, portas e protocolos.
     5. Assegure-se de que não existam regras genéricas ou amplas, como acesso aberto a partir de qualquer IP (0.0.0.0/0).
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. No painel de navegação, clique em 'Security Groups'.
     3. Escolha o grupo de segurança que precisa de ajustes e clique em 'Edit inbound rules' ou 'Edit outbound rules'.
     4. Remova quaisquer regras excessivamente permissivas e adicione regras que restrinjam o tráfego ao necessário. Por exemplo, limite o acesso SSH (porta 22) apenas aos IPs de origem confiáveis.
     5. Salve as configurações e repita o processo para outras regras e grupos de segurança conforme necessário.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)

### **Atualize Regularmente o Sistema Operacional e Aplicações em sua Instância**
   - **Controle ID:** ec2_endpoint_control_005
   - **Racional:** Manter o sistema operacional e as aplicações atualizados é crucial para proteger as instâncias contra vulnerabilidades conhecidas e explorações de segurança, garantindo que patches de segurança sejam aplicados prontamente.
   - **Riscos Mitigados:** Mitiga o risco de ataques baseados em vulnerabilidades conhecidas e não corrigidas, melhorando a segurança geral da infraestrutura.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias que deseja verificar e verifique o último log de atualizações de software no sistema operacional.
     3. Use ferramentas de gerenciamento de patches ou consultas de linha de comando específicas para o sistema operacional para verificar a data da última atualização de patches.
     4. Confira se todas as aplicações críticas dentro das instâncias também estão atualizadas.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias que necessitam de atualização.
     3. Conecte-se às instâncias via SSH (para sistemas baseados em Linux) ou RDP (para sistemas baseados em Windows).
     4. Execute os comandos apropriados para atualizar o sistema operacional, como `sudo apt-get update && sudo apt-get upgrade` para sistemas Debian/Ubuntu ou `sudo yum update` para sistemas Red Hat/CentOS.
     5. Verifique e atualize as aplicações instaladas usando os gerenciadores de pacotes ou ferramentas específicas de cada aplicação.
     6. Reinicie a instância, se necessário, para garantir que todas as atualizações tenham efeito.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)

### **Utilize o Amazon Inspector para Descobrir e Verificar Automaticamente Vulnerabilidades de Software e Exposições de Rede nas Instâncias EC2**
   - **Controle ID:** ec2_endpoint_control_006
   - **Racional:** O Amazon Inspector ajuda a identificar automaticamente vulnerabilidades de software e exposições de rede em instâncias EC2, permitindo a rápida detecção e remediação de potenciais ameaças à segurança.
   - **Riscos Mitigados:** Mitiga o risco de exploração de vulnerabilidades desconhecidas e não gerenciadas, fortalecendo a segurança das instâncias EC2.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço Amazon Inspector.
     2. Verifique se há uma configuração de avaliação existente para as instâncias EC2.
     3. Revise os relatórios de avaliação recentes para identificar qualquer sinal de vulnerabilidade ou exposição de rede.
     4. Assegure-se de que as avaliações estão sendo executadas regularmente conforme configurado.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço Amazon Inspector.
     2. Se necessário, crie uma nova configuração de avaliação:
        - Clique em 'Assessment templates' e depois em 'Create'.
        - Selecione o modelo apropriado para as instâncias EC2 ou crie um modelo personalizado.
        - Configure o cronograma de avaliação para executar análises regularmente.
     3. Inicie uma avaliação imediatamente para verificar o estado atual das instâncias EC2.
     4. Revise os resultados das avaliações e tome as medidas necessárias para remediar quaisquer vulnerabilidades ou exposições identificadas.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia do usuário do Amazon Inspector](https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html)

### **Monitore seus Recursos EC2 usando os Controles do AWS Security Hub**
   - **Controle ID:** ec2_endpoint_control_007
   - **Racional:** Utilizar o AWS Security Hub para monitorar recursos EC2 proporciona uma visão centralizada da postura de segurança, facilitando a identificação e o gerenciamento de potenciais ameaças e vulnerabilidades em tempo real.
   - **Riscos Mitigados:** Mitiga o risco de falhas de segurança não detectadas e não gerenciadas, aumentando a capacidade de resposta a incidentes de segurança.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço AWS Security Hub.
     2. Verifique se o Security Hub está ativado.
     3. Revise os painéis de controle e relatórios para verificar o monitoramento das instâncias EC2.
     4. Verifique se os controles específicos para EC2 estão configurados e se os resultados das auditorias estão sendo devidamente registrados.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço AWS Security Hub.
     2. Se o Security Hub ainda não estiver ativado, ative-o seguindo as instruções fornecidas pelo serviço.
     3. Configure integrações específicas para monitoramento de EC2, seguindo as orientações para adicionar padrões de segurança relevantes e controles automatizados.
     4. Personalize as configurações para garantir que todos os aspectos necessários das instâncias EC2 estejam sendo monitorados.
     5. Revise regularmente os relatórios e alertas gerados pelo Security Hub para manter uma vigilância contínua sobre a segurança das instâncias EC2.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia do usuário do AWS Security Hub](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-user-guide.html)

### **Separe os Volumes do Amazon EBS para Sistema Operacional e Dados, Garantindo a Persistência dos Dados Após o Término da Instância**
   - **Controle ID:** ec2_endpoint_control_008
   - **Racional:** Separar os volumes do Amazon EBS destinados ao sistema operacional dos volumes de dados ajuda a preservar os dados importantes após o término de uma instância, além de facilitar a gestão de backups e a escalabilidade.
   - **Riscos Mitigados:** Mitiga o risco de perda de dados críticos em caso de falhas ou término da instância, garantindo a recuperação eficiente e a integridade dos dados.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias em análise e verifique a configuração dos volumes EBS anexados.
     3. Confirme que existem volumes separados para o sistema operacional e para os dados.
     4. Verifique se os volumes de dados estão configurados para não serem excluídos automaticamente ao término da instância (opção 'Delete on Termination' desabilitada).
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Ao configurar uma nova instância, na seção 'Add Storage', adicione volumes EBS separados para o sistema operacional e para os dados.
     3. Certifique-se de marcar a opção 'Delete on Termination' como desabilitada para os volumes de dados, garantindo sua persistência após o término da instância.
     4. Revise as configurações de segurança e backup para os volumes de dados, garantindo que estão de acordo com as políticas de proteção de dados da organização.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)

### **Encripte Volumes e Snapshots do EBS**
   - **Controle ID:** ec2_endpoint_control_009
   - **Racional:** A criptografia de volumes e snapshots do EBS protege os dados em repouso dentro da nuvem, garantindo que informações sensíveis estejam seguras contra acessos não autorizados, mesmo que os meios físicos sejam comprometidos.
   - **Riscos Mitigados:** Mitiga o risco de exposição de dados sensíveis, aumentando a segurança dos dados armazenados em volumes EBS e seus respectivos snapshots.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. No painel de navegação, clique em 'Volumes' e 'Snapshots' para revisar os existentes.
     3. Verifique se todos os volumes e snapshots listados estão criptografados. Isso pode ser identificado pelo status de criptografia na coluna de informações de cada recurso.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Para criar um novo volume EBS criptografado:
        - Clique em 'Create Volume', selecione os parâmetros desejados, e assegure-se de marcar a opção 'Encrypt this volume'.
        - Escolha uma chave de criptografia gerida pela AWS (AWS-managed key) ou selecione uma chave de criptografia personalizada que você gerencia (customer-managed key).
     3. Para criptografar um volume EBS existente que não está criptografado, você precisará criar um snapshot criptografado do volume e, então, criar um novo volume a partir desse snapshot criptografado.
     4. Para snapshots, certifique-se de que, ao criar um novo snapshot, a opção de criptografia esteja habilitada.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia de criptografia de volumes EBS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html)

### **Utilize Metadados de Instância e Tags de Recursos Personalizadas para Rastrear e Identificar seus Recursos AWS**
   - **Controle ID:** ec2_endpoint_control_010
   - **Racional:** Utilizar metadados de instância e tags de recursos personalizadas permite uma gestão eficiente dos recursos, facilitando a identificação, o rastreamento e a organização de instâncias e outros recursos na AWS. Isso auxilia no controle de custos, na governança e na aderência a políticas de compliance.
   - **Riscos Mitigados:** Mitiga o risco de desorganização e falta de controle sobre os recursos, o que pode levar a erros operacionais e dificuldades na aplicação de políticas de segurança e auditoria.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias para revisão e verifique as tags aplicadas a cada uma.
     3. Confira se as tags estão completas e corretamente aplicadas, incluindo informações como ambiente, propósito, departamento, responsável e data de criação.
     4. Verifique se os metadados das instâncias estão sendo utilizados e registrados conforme necessário para a gestão e operação dos recursos.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione ou crie uma instância para a qual deseja adicionar tags.
     3. No menu de ações da instância, escolha 'Manage Tags'.
     4. Adicione ou atualize as tags conforme necessário para incluir todos os metadados relevantes para a gestão e identificação dos recursos, como 'Environment', 'Purpose', 'Owner', 'CreationDate', etc.
     5. Garanta que todas as novas instâncias e recursos criados sigam um padrão de tag definido pela política de governança de TI da organização.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia de utilização de tags em recursos da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html)

### **Faça Backups Regulares de seus Volumes EBS usando Snapshots do EBS e Crie uma AMI de sua Instância para Salvar a Configuração**
   - **Controle ID:** ec2_endpoint_control_011
   - **Racional:** Realizar backups regulares dos volumes EBS por meio de snapshots e criar uma AMI (Amazon Machine Image) da instância assegura a recuperação rápida em caso de falhas, desastres ou corrupções de dados, além de preservar a configuração da instância para uso futuro ou replicação rápida.
   - **Riscos Mitigados:** Mitiga o risco de perda de dados significativa e interrupções prolongadas de serviço devido a falhas de hardware, ataques cibernéticos ou desastres naturais.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. No painel de navegação, clique em 'Snapshots' e verifique os snapshots recentes para os volumes EBS associados às instâncias críticas.
     3. Confira se os snapshots estão sendo feitos conforme uma programação regular e se as AMIs das instâncias estão sendo atualizadas após mudanças significativas na configuração.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Para criar um snapshot de um volume EBS:
        - Selecione o volume desejado, clique em 'Actions' e escolha 'Create Snapshot'.
        - Forneça uma descrição e adicione tags, se necessário.
     3. Para criar uma AMI da instância:
        - Selecione a instância, clique em 'Actions', navegue até 'Image and templates' e escolha 'Create image'.
        - Forneça um nome e uma descrição para a AMI e configure opções como 'No reboot', se necessário.
     4. Estabeleça políticas de backup, incluindo a frequência de criação de snapshots e AMIs, para garantir que os dados e configurações estejam sempre atualizados e seguros.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia de backup usando snapshots do EBS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-creating-snapshot.html)
     - [Guia para criar uma AMI](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/creating-an-ami-ebs.html)

### **Implemente Componentes Críticos de sua Aplicação em Múltiplas Zonas de Disponibilidade e Replique seus Dados Apropriadamente**
   - **Controle ID:** ec2_endpoint_control_012
   - **Racional:** A implementação de componentes críticos da aplicação em múltiplas zonas de disponibilidade e a replicação apropriada de dados entre essas zonas aumenta a resiliência e a disponibilidade do serviço, reduzindo o risco de interrupções devido a falhas em uma única localização.
   - **Riscos Mitigados:** Mitiga o risco de interrupções de serviço e perda de dados causados por falhas regionais, desastres naturais ou problemas de infraestrutura, garantindo alta disponibilidade e continuidade de negócios.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Verifique as instâncias e identifique em quais zonas de disponibilidade cada componente da aplicação está operando.
     3. Revise a estratégia de replicação de dados para garantir que está configurada corretamente entre as zonas de disponibilidade.
     4. Confirme se há políticas e mecanismos automáticos de failover para garantir a operação contínua em caso de falha em uma zona.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Ao criar novas instâncias ou migrar instâncias existentes, assegure-se de distribuí-las entre múltiplas zonas de disponibilidade.
     3. Configure os serviços de balanceamento de carga e auto-scaling para gerenciar automaticamente o tráfego entre as instâncias em diferentes zonas.
     4. Implemente soluções de replicação de dados, como Amazon RDS para bancos de dados ou Amazon EFS para sistemas de arquivos, que suportem replicação multi-zona.
     5. Revise e teste regularmente as estratégias de failover para verificar sua eficácia em cenários de falha.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia para alta disponibilidade e recuperação de desastres na AWS](https://aws.amazon.com/architecture/resilience/)

### **Monitore e Responda a Eventos em suas Instâncias EC2**
   - **Controle ID:** ec2_endpoint_control_013
   - **Racional:** Monitorar e responder a eventos nas instâncias EC2 é essencial para manter a segurança operacional, identificar e mitigar incidentes em tempo real, e assegurar a saúde e a performance dos sistemas.
   - **Riscos Mitigados:** Mitiga o risco de impactos negativos devido a falhas de sistema, ataques cibernéticos ou falhas de performance não detectadas, permitindo respostas rápidas a incidentes.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2 ou CloudWatch.
     2. Verifique se as métricas de monitoramento estão configuradas para as instâncias EC2.
     3. Revise os alarmes configurados no CloudWatch para verificar se estão apropriados para os tipos de eventos que necessitam de monitoramento e resposta.
     4. Verifique se há logs de eventos e respostas automáticas configuradas para atuar em caso de incidentes detectados.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2 ou CloudWatch.
     2. Configure ou revise o monitoramento de métricas e logs para as instâncias EC2 usando CloudWatch:
        - Em CloudWatch, configure novas métricas e alarmes que sejam relevantes para a operação e segurança das suas instâncias.
     3. Estabeleça respostas automáticas usando o AWS Lambda ou SNS (Simple Notification Service) para atuar quando determinados alarmes ou eventos são disparados:
        - Por exemplo, configure um alarme para reiniciar uma instância se ela atingir um uso de CPU crítico, ou enviar uma notificação para a equipe de TI se atividades suspeitas forem detectadas.
     4. Teste e valide as configurações de monitoramento e resposta para assegurar que estão funcionando como esperado.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia de utilização do Amazon CloudWatch para monitoramento](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html)

### **Teste Regularmente o Processo de Recuperação de suas Instâncias e Volumes EBS para Garantir que Dados e Serviços sejam Restaurados com Sucesso**
   - **Controle ID:** ec2_endpoint_control_014
   - **Racional:** Testar regularmente os processos de recuperação de instâncias e volumes EBS é crucial para assegurar que os procedimentos de backup e restauração são eficazes e que os dados e serviços podem ser restaurados com sucesso após um incidente.
   - **Riscos Mitigados:** Mitiga o risco de não conseguir recuperar dados e serviços essenciais após falhas ou desastres, garantindo a continuidade dos negócios e a integridade dos dados.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Revise os registros de testes de recuperação realizados, verificando a data, o escopo e os resultados de cada teste.
     3. Confira se os testes abordam todas as instâncias e volumes críticos e se os procedimentos de recuperação estão documentados e são facilmente acessíveis.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Planeje e execute testes de recuperação regularmente:
        - Escolha instâncias e volumes EBS para testar.
        - Utilize snapshots ou AMIs recentes para restaurar os volumes ou instâncias em um ambiente de teste.
        - Verifique se os dados e as funcionalidades das aplicações são restaurados conforme o esperado.
     3. Atualize os procedimentos de recuperação com base nos resultados dos testes para corrigir quaisquer falhas ou melhorar a eficiência do processo.
     4. Documente cada teste de recuperação, incluindo as configurações testadas, os resultados obtidos e as ações tomadas após o teste.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)
     - [Guia para restauração de volumes EBS a partir de snapshots](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-restoring-volume.html)
     - [Guia para utilização de AMIs na recuperação de instâncias](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html)

### **Configure o TTL (Time-to-Live) para 255 em suas Aplicações para Evitar Problemas de Alcançabilidade**
   - **Controle ID:** ec2_endpoint_control_015
   - **Racional:** Configurar o TTL (Time-to-Live) para 255 nas aplicações que operam em instâncias EC2 ajuda a prevenir problemas de alcançabilidade de rede, assegurando que os pacotes sejam entregues sem serem descartados devido a TTL baixo, especialmente em ambientes com múltiplas sub-redes ou segmentos de rede.
   - **Riscos Mitigados:** Mitiga o risco de falhas de comunicação e perda de pacotes devido a configurações inadequadas de TTL, que podem levar a interrupções de serviço e problemas de conectividade.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Verifique as configurações de rede das instâncias e os scripts de inicialização que configuram o TTL dos pacotes IP enviados pelas aplicações.
     3. Utilize ferramentas de diagnóstico de rede para capturar pacotes e verificar se o TTL configurado é mantido como 255.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias que precisam de ajuste no TTL.
     3. Conecte-se às instâncias via SSH.
     4. Modifique as configurações de rede para estabelecer o TTL padrão para 255. Isso pode ser feito adicionando uma regra ao script de inicialização da instância ou configurando diretamente no sistema operacional, por exemplo:
        - Para sistemas baseados em Linux, edite o arquivo `/etc/sysctl.conf` e adicione a linha `net.ipv4.ip_default_ttl=255`, depois aplique a configuração com `sysctl -p`.
     5. Reinicie as instâncias, se necessário, para garantir que as novas configurações de TTL entrem em vigor.
   - **Referências:**
     - [Melhores práticas para Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html)

### **Mantenha os Drivers Atualizados em Todas as Instâncias Windows EC2**
   - **Controle ID:** ec2_endpoint_control_016
   - **Racional:** Manter os drivers atualizados em instâncias Windows EC2 é essencial para garantir a compatibilidade e o desempenho ótimo dos sistemas, além de reduzir vulnerabilidades de segurança associadas a drivers desatualizados.
   - **Riscos Mitigados:** Mitiga o risco de falhas de sistema, problemas de compatibilidade e exposições de segurança devido a drivers desatualizados ou corrompidos.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias Windows que deseja verificar.
     3. Conecte-se às instâncias via Remote Desktop Protocol (RDP).
     4. Verifique a versão dos drivers instalados utilizando o Gerenciador de Dispositivos ou ferramentas de terceiros que fornecem detalhes completos sobre os drivers.
     5. Compare as versões instaladas com as últimas versões disponíveis no site do fabricante ou nas atualizações do Windows Update.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Conecte-se às instâncias Windows via RDP.
     3. Abra o Windows Update e verifique se há atualizações de drivers disponíveis. Instale todas as atualizações recomendadas.
     4. Para drivers específicos não cobertos pelo Windows Update, visite o site do fabricante do hardware, baixe os drivers mais recentes e siga as instruções de instalação fornecidas pelo fabricante.
     5. Reinicie as instâncias, se necessário, para garantir que as atualizações de drivers sejam aplicadas corretamente.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Gerenciamento de dispositivos e drivers no Windows](https://docs.microsoft.com/en-us/windows-hardware/drivers/)

### **Utilize os AMIs Windows mais Recentes para Novas Instâncias**
   - **Controle ID:** ec2_endpoint_control_017
   - **Racional:** Utilizar as Amazon Machine Images (AMIs) mais recentes para novas instâncias Windows garante que você esteja aproveitando as últimas atualizações de segurança e recursos de desempenho, minimizando a exposição a vulnerabilidades e maximizando a eficiência operacional.
   - **Riscos Mitigados:** Mitiga o risco de vulnerabilidades de segurança associadas a sistemas operacionais desatualizados, além de potenciais problemas de compatibilidade e desempenho.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Revise as instâncias recentemente criadas e verifique a AMI utilizada.
     3. Compare a AMI das instâncias com as versões mais recentes disponíveis no AWS Marketplace.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Para criar uma nova instância, selecione a opção "Launch Instance".
     3. No AWS Marketplace, pesquise pelas AMIs Windows mais recentes e selecione a mais apropriada para suas necessidades.
     4. Continue o processo de criação da instância, configurando redes, grupos de segurança e outros parâmetros necessários.
     5. Certifique-se de manter um processo de revisão periódica para sempre utilizar as AMIs mais atualizadas em novas implantações.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [AWS Marketplace para AMIs Windows](https://aws.amazon.com/marketplace)

### **Atualize para o Agente EC2Launch v2 mais Recente**
   - **Controle ID:** ec2_endpoint_control_018
   - **Racional:** Atualizar para a versão mais recente do agente EC2Launch v2 em instâncias Windows EC2 garante que você esteja utilizando as funcionalidades mais avançadas para configuração e gerenciamento de instâncias, além de melhorar a segurança e o desempenho.
   - **Riscos Mitigados:** Mitiga o risco associado a falhas de segurança e problemas de desempenho que podem ocorrer com versões desatualizadas do agente, além de garantir compatibilidade com as últimas atualizações do Windows.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias Windows que deseja verificar.
     3. Conecte-se às instâncias via Remote Desktop Protocol (RDP).
     4. Verifique a versão do agente EC2Launch v2 instalada, acessando o diretório onde o agente está instalado ou consultando através do Painel de Controle -> Programas.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Conecte-se às instâncias Windows que necessitam de atualização do agente EC2Launch v2 via RDP.
     3. Acesse o site da AWS ou o console de gerenciamento EC2 para baixar a versão mais recente do EC2Launch v2.
     4. Execute o instalador para atualizar o agente na instância.
     5. Siga as instruções de instalação fornecidas pela AWS para garantir que o agente seja atualizado corretamente.
     6. Reinicie a instância, se necessário, para completar a atualização.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Documentação do EC2Launch v2](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/ec2launch-v2.html)

### **Implemente Serviços de Domínio do Active Directory para Infraestrutura Segura e Gerenciável**
   - **Controle ID:** ec2_endpoint_control_019
   - **Racional:** A implementação dos Serviços de Domínio do Active Directory (AD) em instâncias Windows EC2 permite uma gestão centralizada de políticas de usuário e segurança, facilitando o controle de acesso, autenticação e autorização dentro da infraestrutura de TI.
   - **Riscos Mitigados:** Mitiga o risco de acessos não autorizados, melhorando a segurança da infraestrutura através de uma gestão de identidades e acessos eficiente e centralizada.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2 ou o serviço AWS Directory Service.
     2. Verifique se existe um diretório do Active Directory configurado e ativo.
     3. Confira se as instâncias Windows EC2 estão corretamente integradas ao AD, verificando as configurações de domínio nas próprias instâncias.
     4. Avalie as políticas de grupo aplicadas e os registros de auditoria para verificar a conformidade e a eficácia das políticas de segurança.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço AWS Directory Service.
     2. Se ainda não houver um serviço de diretório configurado, crie um novo diretório do Active Directory:
        - Escolha entre AWS Managed Microsoft AD, AD Connector ou Simple AD, dependendo dos requisitos específicos da sua organização.
     3. Siga as instruções para configurar o diretório, incluindo detalhes como nome de domínio, VPC e configurações de segurança.
     4. Integre suas instâncias Windows EC2 ao Active Directory configurado:
        - Junte as instâncias EC2 ao domínio através das configurações de sistema no Painel de Controle.
     5. Configure as políticas de grupo (GPOs) conforme necessário para gerenciar as configurações de segurança e de usuário em todas as instâncias.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Guia do AWS Directory Service](https://docs.aws.amazon.com/directoryservice/latest/admin-guide/what_is.html)

### **Aplique o Princípio de Menor Privilégio para Instâncias e Contas**
   - **Controle ID:** ec2_endpoint_control_020
   - **Racional:** Aplicar o princípio de menor privilégio em instâncias e contas AWS garante que cada usuário, processo e sistema tenha apenas os privilégios essenciais para realizar suas funções designadas. Este controle reduz o risco de danos causados por acidentes, erros ou abuso de privilégios.
   - **Riscos Mitigados:** Mitiga o risco de acessos não autorizados e limita o potencial de danos em caso de comprometimento de contas, contribuindo significativamente para a segurança da infraestrutura.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço IAM (Identity and Access Management).
     2. Revise as políticas de IAM aplicadas a usuários, grupos e roles para verificar se estão de acordo com o princípio de menor privilégio.
     3. Confira as permissões atribuídas às instâncias EC2 através de roles de IAM e verifique se elas são estritamente necessárias para as operações da instância.
     4. Analise os logs de auditoria para identificar qualquer uso de privilégios que exceda o necessário para as tarefas usuais.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço IAM.
     2. Revise e ajuste as políticas de IAM, restringindo o acesso a recursos e ações apenas ao necessário. Utilize a ferramenta IAM Policy Simulator para testar as políticas antes de aplicá-las.
     3. Aplique roles de IAM específicas às instâncias EC2 que limitam o acesso a recursos apenas ao essencial para a função da instância.
     4. Estabeleça um processo de revisão periódica das permissões de IAM e das configurações de segurança das instâncias para garantir a conformidade contínua com o princípio de menor privilégio.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Guia de administração do IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html)

### **Crie uma Configuração de Servidor Baseline que Incorpore Patches de Segurança Atualizados**
   - **Controle ID:** ec2_endpoint_control_021
   - **Racional:** Estabelecer uma configuração baseline para servidores que inclua a aplicação de patches de segurança atualizados é crucial para proteger as instâncias contra vulnerabilidades conhecidas. Isso garante que todas as novas instâncias sejam configuradas com um nível de segurança robusto desde o início.
   - **Riscos Mitigados:** Mitiga o risco de ataques explorando vulnerabilidades conhecidas que poderiam ser evitadas através da aplicação de patches de segurança.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias Windows para verificar se a configuração segue a baseline definida.
     3. Use ferramentas como o Microsoft Baseline Security Analyzer para verificar se todos os patches de segurança recomendados estão aplicados.
     4. Verifique se a configuração das instâncias está em conformidade com as políticas internas e melhores práticas de segurança.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Desenvolva e aplique uma imagem de servidor (AMI) que inclua o sistema operacional Windows com todos os patches de segurança mais recentes instalados. Esta AMI servirá como a baseline para futuras implantações.
     3. Utilize políticas de grupo ou ferramentas de gestão de configuração como Ansible, Chef, ou Puppet para garantir que a configuração de baseline seja mantida em todas as instâncias.
     4. Automatize o processo de atualizações regulares para garantir que todos os servidores estejam sempre atualizados com os últimos patches de segurança.
     5. Revise e atualize a baseline periodicamente para incorporar novos patches de segurança e mudanças nas melhores práticas.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Microsoft Baseline Security Analyzer](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-security-baseline-analyzer)

### **Implemente Processos de Gerenciamento de Mudanças Controladas para Configurações de Servidor**
   - **Controle ID:** ec2_endpoint_control_022
   - **Racional:** Implementar processos de gerenciamento de mudanças controladas para as configurações de servidor em instâncias EC2 Windows é essencial para garantir que todas as alterações sejam avaliadas, aprovadas e documentadas adequadamente antes de serem implementadas. Isso ajuda a manter a integridade e a estabilidade do ambiente operacional.
   - **Riscos Mitigados:** Mitiga o risco de interrupções não planejadas e potenciais vulnerabilidades de segurança que podem surgir de mudanças não controladas ou mal gerenciadas.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Revise os registros de mudanças para as configurações de servidor das instâncias Windows, verificando se todas as alterações foram documentadas, aprovadas e testadas antes da implementação.
     3. Verifique se há um processo formal de revisão e aprovação para mudanças nas configurações que é seguido consistentemente.
     4. Assegure-se de que existem registros de quaisquer incidentes ou problemas relacionados a mudanças nas configurações, e que lições foram aprendidas e aplicadas em processos futuros.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Estabeleça ou refine o processo de gerenciamento de mudanças para incluir:
        - Uma política clara de gerenciamento de mudanças que exija documentação detalhada, revisão, e aprovação antes de qualquer mudança ser implementada.
        - Ferramentas e plataformas para gerenciar e rastrear mudanças, como JIRA ou ServiceNow, que facilitam o registro e a revisão de mudanças.
        - Um ambiente de teste para validar mudanças antes da implementação em produção.
        - Treinamento regular para a equipe de TI sobre os procedimentos de gerenciamento de mudanças.
     3. Realize auditorias regulares do processo de gerenciamento de mudanças para garantir sua eficácia e conformidade com as políticas estabelecidas.
     4. Ajuste o processo conforme necessário para lidar com novos desafios ou melhorias identificadas durante as auditorias.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Guia para implementação de um processo de gerenciamento de mudanças eficaz](https://www.itil-docs.com/change-management-process-flow/)

### **Implemente Processos Regulares de Patch e Atualização para o Sistema Operacional e Aplicações**
   - **Controle ID:** ec2_endpoint_control_023
   - **Racional:** A implementação de processos regulares de patch e atualização para o sistema operacional e aplicações em instâncias EC2 Windows é fundamental para garantir a segurança e a funcionalidade dos sistemas. Isso protege contra vulnerabilidades conhecidas e melhora a estabilidade e desempenho dos sistemas.
   - **Riscos Mitigados:** Mitiga o risco de exposição a vulnerabilidades de segurança não corrigidas, ataques cibernéticos e falhas de sistema devido a softwares desatualizados.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Selecione as instâncias Windows e verifique o histórico de atualizações para confirmar que os patches de segurança e atualizações de software foram aplicados regularmente.
     3. Utilize ferramentas como o Windows Server Update Services (WSUS) ou o próprio Windows Update para verificar o status de atualização das instâncias.
     4. Confira se há políticas e procedimentos documentados que regem o processo de atualização e se eles estão sendo seguidos.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Estabeleça ou aprimore um cronograma regular para atualizações e patches. Considere a criação de uma política de atualização que inclua:
        - Frequência de verificações e instalações de atualizações.
        - Uso de uma ferramenta centralizada de gerenciamento de patches como o WSUS para gerenciar e distribuir atualizações para as instâncias.
        - Procedimentos para testar patches em um ambiente de teste antes da implantação em produção.
     3. Automatize o processo de atualização, se possível, para garantir que todas as instâncias recebam os patches necessários sem intervenção manual.
     4. Realize auditorias regulares para verificar a conformidade com o cronograma de atualizações e ajuste o processo conforme necessário para melhorar a eficiência e a eficácia.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Guia do Windows Server Update Services (WSUS)](https://docs.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus)

### **Audite o Acesso e Todas as Alterações nas Instâncias EC2 para Verificar a Integridade do Servidor**
   - **Controle ID:** ec2_endpoint_control_024
   - **Racional:** Auditar o acesso e todas as alterações nas instâncias EC2 Windows é crucial para garantir a integridade e segurança dos servidores. Isso ajuda a identificar atividades suspeitas ou não autorizadas e a manter a conformidade com as políticas de segurança internas.
   - **Riscos Mitigados:** Mitiga o risco de acesso não autorizado, alterações mal-intencionadas ou inadvertidas em configurações críticas, e potenciais vulnerabilidades de segurança resultantes de modificações não monitoradas.
   - **Auditoria:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Utilize o AWS CloudTrail e outros serviços de monitoramento para verificar registros de acesso e alterações nas instâncias.
     3. Revise os logs de eventos do Windows e registros do CloudTrail para verificar todas as atividades de login e alterações feitas nas instâncias.
     4. Confira se as políticas e práticas de auditoria estão sendo aplicadas consistentemente em todas as instâncias.
   - **Remediação:**
     1. Acesse o console da AWS e vá para o serviço EC2.
     2. Garanta que o AWS CloudTrail esteja ativado para todas as instâncias EC2, capturando todas as ações realizadas via AWS Management Console, AWS SDKs, ferramentas de linha de comando e outras APIs da AWS.
     3. Configure alertas para atividades suspeitas ou não autorizadas usando o Amazon CloudWatch ou AWS Config, integrados ao CloudTrail.
     4. Estabeleça políticas de segurança que definam claramente quem pode acessar as instâncias EC2 e quais ações são permitidas.
     5. Treine a equipe para responder a incidentes de segurança com base nos insights obtidos através da auditoria.
     6. Realize revisões regulares dos registros de auditoria para identificar padrões anormais que possam indicar problemas de segurança.
   - **Referências:**
     - [Melhores práticas para Windows na Amazon EC2 na documentação da AWS](https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ec2-best-practices.html)
     - [Guia do AWS CloudTrail](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-user-guide.html)
